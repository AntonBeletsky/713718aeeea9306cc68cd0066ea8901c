(("undefined"!=typeof self?self:this).wpJsonpChessCom=("undefined"!=typeof self?self:this).wpJsonpChessCom||[]).push([["fcm-loader"],{"./node_modules/tslib/tslib.es6.js":function(e,t,n){e.exports=n("dll-reference coreDLL")("./node_modules/tslib/tslib.es6.js")},"./node_modules/webpack/buildin/global.js":function(e,t,n){e.exports=n("dll-reference coreDLL")("./node_modules/webpack/buildin/global.js")},"./utils/fcm/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"requestHandler",(function(){return requestHandler}));window.location.pathname,encodeURIComponent(window.document.title),encodeURIComponent(window.location.href);const o={chrome:"Chrome",edge:"edge",firefox:"Firefox",ie:"IE",safari:"Safari",waterfox:"Waterfox"},getBrowser=(e=window.navigator.userAgent)=>{let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(((e=window.navigator.userAgent)=>null!==e.match(/Edg/))(e)){const t=e.indexOf("Edg");let n=4;e.match("Edge/")&&(n=5);const o=t+n;return{name:"Edge",version:parseInt(e.substring(o,e.indexOf(".",o)),10)}}if(/trident/i.test(n[1]))return t=/\brv[ :]+(\d+)/g.exec(e)||[],{name:"IE",version:parseInt(t[1]||"-1",10)};if(n[1]===o.chrome&&(t=e.match(/\bOPR\/(\d+)/),null!=t))return{name:"Opera",version:parseInt(t[1],10)};if(n[1]===o.firefox){const t=e.match(/(waterfox(?=\/))\/?\s*(\d+)/i)||[];if(t[1]===o.waterfox)return{name:t[1],version:parseInt(t[2],10)}}return n=n[2]?[n[1],n[2]]:[window.navigator.appName,window.navigator.appVersion,"-?"],n[0]===o.safari&&(t=e.match(/version\/(\d+)/i),null!=t&&n.splice(1,1,t[1])),"MSIE"===n[0]?{name:o.ie,version:parseInt(n[1],10)}:{name:n[0],version:parseInt(n[1],10)}};var s,i,r=n("./utils/translator.ts");const a="notifications-request-confirm",c="notifications-request-decline",l=(r.default.trans("Get Notifications in Your Browser?"),r.default.trans("It’s your move - or someone wants to play"),r.default.trans("You get a new Message or Friend Request"),r.default.trans("Your favorite chess celebrities are playing live"),r.default.trans("A ChessTV featured event begins"),r.default.trans("Enable Chess.com notifications in your browser, and instantly know when…"),r.default.trans("(You can choose the events that matter to you in your Chess.com Notification settings.)"),{BROWSER:`${getBrowser().name}${getBrowser().version}`,MAX_REQUESTS:2,USER:window.context.user}),u=l.USER&&l.USER.allowBrowserNotifications&&l.USER.allowBrowserNotifications.length>0?l.USER.allowBrowserNotifications:null,d=Date.now()/1e3,f=(i=null==(s=window.context.user)?void 0:s.registerDate,{apiKey:"AIzaSyAoMkjy3zKkqAcPqb2tazB-IOe98QR9psc",authDomain:"chesscom.firebaseapp.com",databaseURL:"https://chesscom.firebaseio.com",projectId:"chesscom",storageBucket:"chesscom.appspot.com",messagingSenderId:"27129061667",appId:"1:27129061667:web:0099c30132ad07e0d22c96"}),m="BD1OOymDvZcsnbr0x6yb4QQFP29QOC1e_UzFXNQ1Km5F1K-KinJjBZW86K6_huzwMklH0hJSVXOyoax3RiKULLM";var w=n("./node_modules/@firebase/app/dist/index.cjs.js"),p=n.n(w),g=n("./utils/router.js"),h=n("./utils/http/index.ts");n("./node_modules/@firebase/messaging/dist/index.esm.js");let b=null,x="";function getMessagingToken(e=!0){b.getToken().then((e=>{e&&h.default.post(g.default.generate("web_fcm_callback_register"),{token:e,browser:l.BROWSER})})).catch((()=>{e&&getMessagingToken(!1)}))}function requestPermission(){Notification.requestPermission().then((e=>{"granted"===e&&getMessagingToken()}))}function customDialogShown(e){h.default.post(g.default.generate("web_fcm_callback_browser_permission_request"),{allowed:e})}function requestHandler(e){e===a&&(customDialogShown(!0),requestPermission()),e===c&&customDialogShown(!1)}window.context.user&&async function boot(){const e=await function registerWorker(){const e=window.Config.pathToFCMWorker;if(e)return navigator.serviceWorker.register(e).catch((()=>!1))}();e&&(p.a.initializeApp(f),b=p.a.messaging(),b.usePublicVapidKey(m),b.useServiceWorker(e),u&&u.forEach((e=>{e.allowed&&requestPermission()})),b.onTokenRefresh((()=>{getMessagingToken()})),b.onMessage((({data:e})=>{if(void 0===e)return;const t=e.body+e.link;if(t===x)return;x=t;const n={body:e.body,icon:e.icon};new Notification(e.title,n).onclick=()=>{window.open(e.link,"_blank")}})))}()},"./utils/http/index.ts":function(e,t,n){e.exports=n("dll-reference coreDLL")("./utils/http/index.ts")},"./utils/router.js":function(e,t,n){e.exports=n("dll-reference coreDLL")("./utils/router.js")},"./utils/translator.ts":function(e,t,n){e.exports=n("dll-reference coreDLL")("./utils/translator.ts")}}]);